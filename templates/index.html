<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarnQuick BD</title>
    <style>
        /* CSS ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® */
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f0f8ff; color: #333; }
        .marquee-container { background-color: #ffcc00; color: #333; padding: 5px 0; overflow: hidden; white-space: nowrap; }
        .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 20px; }
        .balance-info { font-size: 24px; font-weight: bold; color: #007bff; }
        /* ‡¶Ü‡¶∞‡¶ì ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤... */
    </style>
    <script src="[MONETAG_TG_SDK_URL]"></script>
</head>
<body>
    
    <div class="marquee-container">
        <marquee behavior="scroll" direction="left"><span id="runningHeadline">{{ headline }}</span></marquee>
    </div>

    <div class="card">
        <h3>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</h3>
        <p class="balance-info"><span id="currentBalance">...‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span> ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</p>
        <p>‡¶ü‡¶æ‡¶ï‡¶æ: ‡ß≥ <span id="currentBdt">0.00</span></p>
        <p class="task-limit">‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡ßÄ‡¶Æ‡¶æ: <span id="currentTasks">‡ß¶</span>/‡ß©‡ß¶</p>
    </div>
    
    <div class="card" style="background-color: #e6ffe6;">
        <p>üí∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá **‡ß®‡ß´‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü** ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ + ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡¶ï‡ßÉ‡¶§‡ßá‡¶∞ ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶®‡ßá **‡ß¶‡ß´%** ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®‡•§</p>
    </div>

    <div class="card">
        <h3>‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
        <p id="adMessage" style="color: red;"></p>
        <button id="watchAdButton" onclick="watchAdAndGrantReward()">‚ñ∂Ô∏è ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
    </div>

    <div class="card" id="withdrawSection">
        <h3>‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶® (Withdraw)</h3>
        <p>‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞: **{{ min_withdraw_points }}** ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü (‡ß≥ {{ "%.2f"|format(min_withdraw_points / points_per_bdt) }})</p>
        
        <label for="withdrawPoints">‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü:</label>
        <input type="number" id="withdrawPoints" placeholder="{{ min_withdraw_points }}" min="{{ min_withdraw_points }}">
        
        <label for="paymentMethod">‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ:</label>
        <select id="paymentMethod">
            <option value="bKash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂</option>
            <option value="Nagad">‡¶®‡¶ó‡¶¶</option>
            <option value="Rocket">‡¶∞‡¶ï‡ßá‡¶ü</option>
        </select>
        
        <label for="accountNumber">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</label>
        <input type="text" id="accountNumber" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
        
        <button onclick="requestWithdrawal()">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
        <p id="withdrawStatus" style="margin-top: 10px;"></p>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', loadUserData);
        const POINTS_PER_BDT = {{ points_per_bdt }};
        const MIN_WITHDRAW_POINTS = {{ min_withdraw_points }};

        // Monetag SDK ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
        const ZONE_ID = '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞_‡¶Ü‡¶∏‡¶≤_MONETAG_ZONE_ID';
        // ‡¶ß‡¶∞‡ßá ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶≤‡ßã createAdHandler ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤‡¶ø ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß
        const adHandler = createAdHandler(ZONE_ID); 

        // ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (loadUserData, handleAdComplete, watchAdAndGrantReward) 
        // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ 
        // ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá loadUserData ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá‡¶∞ ‡¶™‡¶æ‡¶∂‡¶æ‡¶™‡¶æ‡¶∂‡¶ø BDT-‡¶§‡ßá‡¶ì ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡¶õ‡ßá‡•§
        
        async function loadUserData() {
            // ... (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶°)
            if (data.success) {
                const balance = parseFloat(data.balance);
                document.getElementById('currentBalance').textContent = Math.round(balance);
                // BDT ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
                document.getElementById('currentBdt').textContent = (balance / POINTS_PER_BDT).toFixed(2); 
                document.getElementById('currentTasks').textContent = data.tasks_completed;
            } 
            // ... (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶°)
        }

        async function requestWithdrawal() {
            const points = parseInt(document.getElementById('withdrawPoints').value);
            const method = document.getElementById('paymentMethod').value;
            const account = document.getElementById('accountNumber').value;
            const statusElement = document.getElementById('withdrawStatus');
            
            // ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
            if (points < MIN_WITHDRAW_POINTS || isNaN(points)) {
                statusElement.textContent = `‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶∏‡ßÄ‡¶Æ‡¶æ ${MIN_WITHDRAW_POINTS} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡•§`;
                return;
            }
            if (!account) {
                statusElement.textContent = `‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ï‡•§`;
                return;
            }
            
            // API ‡¶ï‡¶≤
            try {
                const response = await fetch('/api/request_withdraw', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: 123, amount_points: points, method: method, account_number: account })
                });
                const data = await response.json();
                
                if (data.success) {
                    statusElement.textContent = data.message;
                    // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ü‡¶æ ‡¶ó‡ßá‡¶≤‡ßá UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                    loadUserData(); 
                } else {
                    statusElement.textContent = '‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + data.message;
                }
            } catch (error) {
                statusElement.textContent = '‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó‡ßá ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø‡•§';
            }
        }
    </script>
</body>
</html>
